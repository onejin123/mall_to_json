<!DOCTYPE html>
<html lang="ko">
<head>
  <title>Source de V√©rit√©</title>
  <link rel="icon" href="/static/images/logo.png" type="image/png">
  <meta charset="utf-8" />
  <link rel="stylesheet" href="/static/css/style.css">
</head>

<body>
  <!-- ‚úÖ Ï†ïÏ†ÅÏù∏ navbarÎäî include ÎåÄÏã† ÏßÅÏ†ë ÏÇΩÏûÖÌïòÍ±∞ÎÇò JSÎ°ú Î™®ÎìàÌôî -->
  <div class="navbar">
    <a href="/" class="logo">Source de V√©rit√©</a>
    <nav>
      <a href="/">Home</a>
      <a href="/products.html">Products</a>
      <a href="/contact.html">Contact</a>
    </nav>
  </div>

  <!-- üîÅ Ïä¨ÎùºÏù¥Îìú Ïù¥ÎØ∏ÏßÄ ÏòÅÏó≠ (Ï†ïÏ†Å ÎßÅÌÅ¨Î°ú Í≥†Ï†ï) -->
  <a id="sliderLink" href="/product/36">
    <img class="hero_header" id="heroSlider" src="/static/images/onepiece.jpg" alt="One Piece">
  </a>

  <script>
    const images = [
      { src: "/static/images/onepiece.jpg", link: "/product/36" },
      { src: "/static/images/shoe2.jpg", link: "/product/34" },
      { src: "/static/images/supreme.jpg", link: "/product/33" }
    ];

    let currentIndex = 0;
    const slider = document.getElementById('heroSlider');
    const sliderLink = document.getElementById('sliderLink');

    setInterval(() => {
      currentIndex = (currentIndex + 1) % images.length;
      slider.src = images[currentIndex].src;
      sliderLink.href = images[currentIndex].link;
    }, 3000);
  </script>

  <!-- üéØ Ïã†ÏÉÅÌíà Ïä¨ÎùºÏù¥Îìú -->
  <h1 style="text-align:center;">Our new Products</h1>
  <div class="slider-container">
    <button class="prev-btn" disabled>&#10094;</button>
    <div class="products-slider" id="productsSlider">
      <!-- JS will inject product slides here -->
    </div>
    <button class="next-btn">&#10095;</button>
  </div>

  <script>
    const API_BASE = "http://192.168.10.10:8000"; // Ïòà: http://192.168.10.10:8000

    async function fetchProducts() {
      const res = await fetch(`${API_BASE}/api/products`);
      if (!res.ok) throw new Error("ÏÉÅÌíà Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®");
      return await res.json();
    }

    function renderProducts(products) {
      const slider = document.getElementById('productsSlider');
      slider.innerHTML = '';
      products.forEach(prod => {
        const item = document.createElement('div');
        item.className = 'slide-item';
        item.innerHTML = `
          <a href="/product/${prod.id}">
            <img src="/static/${prod.image_path}" alt="${prod.name}" class="product-image">
            <p>${prod.name}</p>
            <p class="price">${prod.price}‚Ç©</p>
          </a>`;
        slider.appendChild(item);
      });
    }

    function updateSlider() {
      const wrapper = document.getElementById('productsSlider');
      const items = wrapper.querySelectorAll('.slide-item');
      const itemsPerView = 4;
      const totalSlides = Math.ceil(items.length / itemsPerView);
      let currentSlide = 0;

      function move(dir) {
        currentSlide = Math.max(0, Math.min(currentSlide + dir, totalSlides - 1));
        const width = items[0]?.offsetWidth || 0;
        wrapper.style.transform = `translateX(-${currentSlide * width * itemsPerView}px)`;
        document.querySelector('.prev-btn').disabled = currentSlide === 0;
        document.querySelector('.next-btn').disabled = currentSlide >= totalSlides - 1;
      }

      document.querySelector('.prev-btn').onclick = () => move(-1);
      document.querySelector('.next-btn').onclick = () => move(1);
      move(0);
      window.addEventListener('resize', () => move(0));
    }

    window.addEventListener('DOMContentLoaded', async () => {
      try {
        const products = await fetchProducts();
        renderProducts(products);
        updateSlider();
      } catch (e) {
        console.error(e);
      }
    });
  </script>

  <!-- footerÎèÑ ÏßÅÏ†ë ÏÇΩÏûÖÌïòÍ±∞ÎÇò jsÎ°ú Î™®ÎìàÌôî -->
  <footer style="text-align:center; margin-top:3rem;">
    <p>¬© 2025 Source de V√©rit√©</p>
  </footer>
</body>
</html>
